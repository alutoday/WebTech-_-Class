<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Thêm Sinh Viên</title>
  </head>
  <body>
    <h2>Thêm Sinh Viên Mới</h2>

    <form
      action="../Controller/C_Student.php?action=add"
      method="post"
      id="addStudentForm"
    >
      <label for="id">ID:</label>
      <input type="text" name="id" id="id" required onblur="checkIdUnique()" />
      <span id="idError" style="color: red"></span>
      <br /><br />

      <label for="name">Tên:</label>
      <input type="text" name="name" required /><br /><br />

      <label for="age">Tuổi:</label>
      <input type="number" name="age" required /><br /><br />

      <label for="university">Trường:</label>
      <input type="text" name="university" required /><br /><br />

      <button type="submit">Thêm</button>
    </form>

    <p><a href="../index.php">Home page</a></p>
    <iframe id="checkIdFrame" style="display: none"></iframe>

    <script>
      function checkIdUnique() {
        const studentId = document.getElementById("id").value;
        const iframe = document.getElementById("checkIdFrame");

        iframe.src = `../Controller/C_Student.php?action=add&checkId=${studentId}`;

        iframe.onload = function () {
          const response = iframe.contentDocument.body.innerText;
          const idError = document.getElementById("idError");

          if (response.trim()) {
            idError.innerText = response;
          } else {
            idError.innerText = "";
          }
        };
      }
    </script>
  </body>
</html>
